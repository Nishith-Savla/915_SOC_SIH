<!DOCTYPE html>
<html>
  <head>
    <title>OT Packet Analyzer</title>

    <!-- Cosmo theme CSS file -->
    <!-- <link rel="stylesheet" href="https://bootswatch.com/5/superhero/bootstrap.min.css">    <link rel="stylesheet" href="https://bootswatch.com/5/superhero/bootstrap.min.css"> -->

    <!-- Import jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<!-- superhero theme -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.0.0/dist/superhero/bootstrap.min.css">

    <!-- Import Materialize JavaScript file -->
    <!-- <link
      rel="stylesheet"
      href="https://bootswatch.com/4/minty/bootstrap.min.css"
    /> -->
    <!-- <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css"
    /> -->
<!-- Include Font Awesome CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-ZGhjg6wEh5yvJ6UjHK6xsJFm2a9Xm5cO+o/YAyoMdu1QwLjJvH+V7B+cFJxn8g7XJjwwfYs7+ZYpyanJ8kKOow==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- HDD -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lobster+Two&display=swap" rel="stylesheet">


    <style>
      .btn-mint {
        background-color: #98ff98;
        color: #333;
        border-color: #98ff98;
      }

      /* button */

      .btn-upload {
        background: linear-gradient(180deg, #007dc1 5%, #0061a7);
        background-color: #007dc1;
        border: 1px solid #124d77;
        border-radius: 8px;
        box-shadow: inset 0 1px 0 0 #54a3f7;
        color: #fff;
        cursor: pointer;
        display: inline-block;
        font-family: Arial;
        font-size: 18px;
        font-weight: 700;
        padding: 16px 32px;
        text-decoration: none;
        text-shadow: 0 1px 0 #154682;
      }

      .btn-upload:hover {
        background: linear-gradient(180deg, #0061a7 5%, #007dc1);
        background-color: #0061a7;
      }
      .btn-upload:active {
        position: relative;
        top: 1px;
      }

/* play pause css */
.play-button {
  padding: 10px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.pause-button {
  padding: 10px;
  background-color: #f44336;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.play-button:hover, .pause-button:hover {
  opacity: 0.8;
}

.play-button:disabled, .pause-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.fa-play, .fa-pause {
  margin-right: 10px;
}

/* Caligraphy */
.caligraphical {
        /* font-family: 'Dancing Script', cursive; */
        font-family: 'Lobster Two', cursive;
        font-size: 3em;
        color: #7e7978;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%' height='10' viewBox='0 0 100 10' preserveAspectRatio='none'%3E%3Cpath d='M0 5 q30 -5, 60 0 q30 5, 40 0' stroke='%23555555' stroke-width='1' fill='none'/%3E%3C/svg%3E");
        background-repeat: repeat-x;
        background-position: bottom;
        padding-bottom: 4px;
        line-height: 1.4;

      }


      .wavy-underline {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%' height='10' viewBox='0 0 100 10' preserveAspectRatio='none'%3E%3Cpath d='M0 5 q30 -5, 60 0 q30 5, 40 0' stroke='%23555555' stroke-width='1' fill='none'/%3E%3C/svg%3E");
  background-repeat: repeat-x;
  background-position: bottom;
  padding-bottom: 4px;
  line-height: 1.4;
}



    </style>

<!-- PARTICLES -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>


<style>
  body {
      background-color: black;
      margin: 0;
      padding: 0;
  }
  #particles-js {
      height: 100vh;
      width: 100%;
      position: absolute;
      pointer-events: none;
  }
</style>

<!-- starfield -->
<!-- <script src="https://cdn.jsdelivr.net/npm/starfield@2.0.2/dist/starfield.min.js"></script> -->


<!-- SOME MORE BOOTSTRAP -->


</head>

  <body class="bg-light" style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36);">
    <!-- PARTICLE -->
    <div id="particles-js"></div>

    <!-- TEAM NAME -->
    <!-- <p class="caligraphical" style="display: flex;justify-content: center;align-items: center;">TEAM 915</p> -->
    <p class="caligraphical" style="display: flex;justify-content: center;align-items: center;">FYP</p>
    <!-- <p style="font-family: 'Lobster Two', cursive; display: flex;justify-content: center;align-items: center;">TEAM 915</p> -->
    
    <!-- <div class="w-200 h-80 m-auto border-dotted border-b-4" > -->
    <div class="container">
      <h1 class="mt-4 mb-4" style="color: rgb(71, 73, 75);display: flex;justify-content: center;align-items: center;font-family: 'Lobster Two', cursive;" >OT Packet Analyzer</h1>
    
      <div style="display: flex;justify-content: center;align-items: center;">
        <svg xmlns="http://www.w3.org/2000/svg" height="73.161" width="80">
          <path
            d="M62.799 19.948C60.018 6.437 46.806-2.262 33.29.518c-11.573 2.38-19.896 12.54-19.95 24.353 0 .562.024 1.139.073 1.748C5.181 27.49-.787 34.87.085 43.1c.806 7.63 7.248 13.417 14.922 13.41h1.749c-.04-.553-.084-1.103-.084-1.666 0-11.956 9.696-21.648 21.655-21.648 11.96 0 21.654 9.692 21.654 21.648 0 .563-.043 1.112-.083 1.665h1.749c10.108.028 18.325-8.142 18.353-18.247.026-9.696-7.519-17.73-17.201-18.314Z"
            fill="#bbdefb"
          />
          <ellipse
            ry="18.317"
            rx="18.322"
            cy="54.844"
            cx="38.326"
            fill="#4caf50"
          />
          <g fill="#fafafa">
            <path
              d="M38.326 66.5a1.665 1.665 0 0 1-1.666-1.665V44.853a1.666 1.666 0 0 1 3.332 0v19.982c0 .92-.746 1.665-1.666 1.665z"
            />
            <path
              d="M44.989 53.179a1.665 1.665 0 0 1-1.18-.487l-5.483-5.484-5.484 5.484a1.666 1.666 0 0 1-2.356-2.354l6.665-6.66a1.666 1.666 0 0 1 2.354 0l6.663 6.66a1.664 1.664 0 0 1-1.18 2.84z"
            />
          </g>
        </svg>
      </div>
      {% with messages = get_flashed_messages() %} {% if messages %}
      <ul>
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %} {% endwith %}
      <form
        action="{{ url_for('analyze') }}"
        method="post"
        enctype="multipart/form-data"
      >
        <div class="form-group" >
          <label style="display: flex;justify-content: center;align-items: center;font-size: 18px;"><p style="padding-top: 4px;">Select <b>.pcap</b> or <b>.pcapng</b> file over here</p>
          </label>

          <!-- Changes -->
          <p style="display: flex;justify-content: center;align-items: center;">
            <label
            
              for="pcap-file"
              title="Upload file from local drive"
              class="btn-upload"
              for="fileElem"
              style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif ; font-size: 1.1em;">
              <!-- <i class="fas fa-hdd"></i>&nbsp; From Device</label> -->
              <img src="{{ url_for('static', filename='harddisk.png') }}" alt="Disk Image"></img>&nbsp; From Device</label>
          </p>
        
          <!-- <input
            type="file"
            name="pcap-file"
            class="form-control-file"
            accept=".pcap,.pcapng,.cap*,.pcapng.cap"
            id="pcap-file"
            hidden
          /> -->
          <input type="file" name="pcap-file" class="form-control-file" id="pcap-file" onchange="showFileName()" />
          <span id="file-name"></span>


<!-- HIDE -->
<style>
  .file-label {
  cursor: pointer;
 
}

.form-control-file {
  display: none;
  
}
#file-name {
  display: flex;
  justify-content: center;
  align-items: center;
}
</style>
<p></p>
<script>
  function showFileName() {
  var fileName = document.getElementById("pcap-file").value;
  fileName = fileName.split("\\").pop(); // remove the fakepath
  document.getElementById("file-name").innerHTML = fileName;
}

</script>


        </div>
        <div  style="display: flex;justify-content: center;align-items: center;">
          <button type="submit" class="btn btn-primary rounded-pill text-uppercase" style="font-family: 'Fira Code', monospace; font-size: 1.2em; border-radius: 10px; text-shadow: 1px 1px 2px #666;">Analyze</button>

        </div>
      </form>


<!-- GRAPH -->
<p></p>

<!-- <p style="display: flex;justify-content: center;align-items: center;">
  <label
  
    for="pcap-file"
    title="Upload file from local drive"
    class="btn-upload"
    for="fileElem"
    style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif ; font-size: 1.1em;"
    ><img src="{{ url_for('static', filename='network.png') }}" ></img>&nbsp; Pcap File</label>
    
</p> -->

<!-- <form action="{{ url_for('graph') }}" method="POST" enctype="multipart/form-data">

  <input type="file" name="pcap-file"accept=".pcap,.pcapng,.cap*,.pcapng.cap" id="pcap-file" hidden />

  <div  style="display: flex;justify-content: center;align-items: center;">
  <button  type="submit"  class="btn btn-primary rounded-pill text-uppercase"  style="font-family: 'Fira Code', monospace; font-size: 1.2em; border-radius: 10px; text-shadow: 1px 1px 2px #666;">Graph</button>
  </div>
</form> -->

<form method="post" action="/graph" enctype="multipart/form-data">

  <div style="display: flex; justify-content: center; align-items: center;">
    <label for="pcap-file" style="position: relative; overflow: hidden; cursor: pointer; border: 1px solid #000; padding: 10px; margin-right: 10px; width: 200px; height: 50px; display: flex; justify-content: center; align-items: center;" class="btn-upload">
      <input type="file" name="pcap-file" id="pcap-file" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;" onchange="showFileName()">
      <img src="{{ url_for('static', filename='network.png') }}" alt="Pcap File" style="margin-right: 5px;">
      <span id="file-name" style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif; font-size: 1.1em;margin-left: 5px;">Pcap File</span>
    </label>
  </div>

  <p></p>
  
  <div style="display: flex; justify-content: center; align-items: center;">
    <input type="submit" value="Upload" class="btn btn-primary rounded-pill text-uppercase" style="font-family: 'Fira Code', monospace; font-size: 1.2em; border-radius: 10px; text-shadow: 1px 1px 2px #666;">
  </div>

</form>

<script>
  function showFileName() {
    var fileInput = document.getElementById('pcap-file');
    var fileName = fileInput.files[0].name;
    var fileNameElement = document.getElementById('file-name');
    fileNameElement.textContent = fileName;
  }
</script>


<!-- <form method="post" action="/graph" enctype="multipart/form-data">
  <input type="file" name="pcap-file"accept=".pcap,.pcapng,.pcapng.cap" id="pcap-file" hidden />

  <div  style="display: flex;justify-content: center;align-items: center;">
  <button  type="submit"  class="btn btn-primary rounded-pill text-uppercase"  style="font-family: 'Fira Code', monospace; font-size: 1.2em; border-radius: 10px; text-shadow: 1px 1px 2px #666;">Graph</button>
  </div>
</form> -->







    </div>
<p></p>
    <div  style="display: flex;justify-content: center;align-items: center;">
    <form id="capture-form">
      <label for="interface" style="font-family: 'Fira Code', monospace; font-size: 1.2em;">Select interface:</label>
      <select id="interface" name="interface" style="background-color: transparent;border: none;position: relative;z-index: 9999;">
        {% for interface in interfaces %}
        <option value="{{ interface }}">{{ interface }}</option>
        {% endfor %}
      </select>
      <br />
      <!-- <p></p> -->
      <label for="file_name" > <p style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36);">Enter file name (with .pcap extension):</p></label>

<!-- <label for="file_name"> Enter file name (with .pcap extension):</label> -->

      <input type="text" id="file_name" name="file_name" style="background-color: transparent;border: 1px solid rgba(82, 81, 81, 0.5);border-radius: 10px;"/>
      <br />
      <input type="button" id="start-capture" value="Start Capture" class="play-button" />
      <i class="fas fa-play"></i>
      <input type="button" id="stop-capture" value="Stop Capture" disabled  class="pause-button"/>
      <i class="fas fa-pause"></i>
<!-- style buttons -->
<!-- <button id="start-capture" class="play-button" value="Start Capture">
  <i class="fas fa-play"></i>
  Start Capture
</button>

<button id="stop-capture" class="pause-button" value="Stop Capture" disabled>
  <i class="fas fa-pause"></i>
  Stop Capture
</button> -->



    </form>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#start-capture").click(function () {
          var interface = $("#interface").val();
          var file_name = $("#file_name").val();
          $.ajax({
            url: "/start_capture",
            type: "POST",
            data: JSON.stringify({
              interface: interface,
              file_name: file_name,
            }),
            contentType: "application/json",
            success: function (response) {
              console.log(response);
              $("#start-capture").attr("disabled", true);
              $("#stop-capture").attr("disabled", false);
            },
          });
        });

        $("#stop-capture").click(function () {
          $.ajax({
            url: "/stop_capture",
            type: "POST",
            success: function (response) {
              console.log(response);
              $("#start-capture").attr("disabled", false);
              $("#stop-capture").attr("disabled", true);
            },
          });
        });
      });
    </script>

<!-- CVE Lookup -->
<script>
  function removeValidityMessage() {
    document.getElementById("vendor").setCustomValidity("");
  }

// add an event listener to the document object
document.addEventListener('keydown', function(event) {
// check if the key pressed was the Enter key
if (event.keyCode === 13) {
// call the passCVE function
passCVE();
}
});




function passCVE() {
  var vendor = document.getElementById("cve").value;
  var pages = document.getElementById("pages").value;
  window.location.href = "/cve/" + vendor + "?pages=" + pages;
}
</script>



<!-- <div
style="
  text-align: center;
  border-bottom: 2.5px groove;
  padding: 6px;
  font-size: 20px;
  background-color: rgb(23, 23, 23);
"> -->
<p></p>
<!-- <div style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36);"> -->

<!-- <label for="vendor">CVE Lookup</label> -->



<!-- </div> -->
<!-- <div style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36);"></div> -->
<div style="display: flex; flex-direction: column; align-items: center;">
  <div style="position: relative;">
    <input type="text" id="cve" style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36); border-radius: 10px; padding-right: 30px;background-color: transparent;" placeholder="Vendor or CVE-ID" />
    <input type="number" id="pages" style="font-family: 'Fira Code', monospace; font-size: 1.1em;color: rgb(37, 36, 36); border-radius: 10px; padding-right: 30px;background-color: transparent;" placeholder="Number of Pages" />
  </div>
<p></p>
  <button class="btn" style="font-family: 'Fira Code', monospace; font-size: 1.4em; border-radius: 10px; text-shadow: 1px 1px 2px #2e0226;color: #ffffff;" onclick="passCVE()">
    <i class="fas fa-search"></i> CVE Lookup
  </button>
</div>



<!-- particle.js -->

<script>
  particlesJS("particles-js", {
      "particles": {
          "number": {
              "value": 100,
              "density": {
                  "enable": true,
                  "value_area": 800
              }
          },
          "color": {
              "value": "#ffffff"
          },
          "shape": {
              "type": "circle",
              "stroke": {
                  "width": 0,
                  "color": "#000000"
              },
              "polygon": {
                  "nb_sides": 5
              },
              "image": {
                  "src": "img/github.svg",
                  "width": 100,
                  "height": 100
              }
          },
          "opacity": {
              "value": 0.6,
              "random": false,
              "anim": {
                  "enable": false,
                  "speed": 1,
                  "opacity_min": 0.1,
                  "sync": false
              }
          },
          "size": {
              "value": 3,
              "random": true,
              "anim": {
                  "enable": false,
                  "speed": 30,
                  "size_min": 0.1,
                  "sync": false
              }
          },
          "line_linked": {
              "enable": true,
              "distance": 150,
              "color": "#ffffff",
              "opacity": 0.4,
              "width": 1
          },
          "move": {
              "enable": true,
              "speed": 6,
              "direction": "none",
              "random": false,
              "straight": false,
              "out_mode": "out",
              "bounce": false,
              "attract": {
                  "enable": false,
                  "rotateX": 600,
                  "rotateY": 1200
              }
          }
      },
      "interactivity": {
          "detect_on": "canvas",
          "events": {
              "onhover": {
                  "enable": true,
                  "mode": "repulse"
              },
              "onclick": {
                  "enable": true,
                  "mode": "push"
              },
              "resize": true
          },
          "modes": {
              "grab": {
                  "distance": 400,
                  "line_linked": {
                      "opacity": 1
                  }
              },
              "bubble": {
                  "distance": 400,
                  "size": 40,
                  "duration": 2,
                  "opacity": 8,
                  "speed": 3
              },
              "repulse": {
                  "distance": 200,
                  "duration": 0.4
              },
              "push": {
                  "particles_nb": 4
              },
              "remove": {
                  "particles_nb": 2
              }
          }
      },
      "retina_detect": true
  });
</script>



  </body>
</html>
